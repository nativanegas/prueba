---
title: "Serie de tiempo"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    social: menu
    source_code: embed
---
```{r setup, include=FALSE}
library(tidyverse)
library(RSocrata)
library(dygraphs)
library(xts)
library(incidence)
library(aTSA)
library(lmtest)
library(forecast)
token <- "ew2rEMuESuzWPqMkyPfOSGJgE"
df.ins <- read.socrata("https://www.datos.gov.co/resource/gt2j-8ykr.json", app_token = token)
df.ins$fis <- as.Date(df.ins$fis, format = "%Y-%m-%d")
df.ins$fecha_de_notificaci_n <- as.Date(df.ins$fecha_de_notificaci_n, format = "%Y-%m-%d")
df.ins$fecha_de_muerte <- as.Date(df.ins$fecha_de_muerte, format = "%Y-%m-%d")
df.ins$fecha_recuperado <- as.Date(df.ins$fecha_recuperado, format = "%Y-%m-%d")
df.ins$fecha_fecha_reporte_web <- as.Date(df.ins$fecha_reporte_web, format = "%Y-%m-%d")
df.ins$fecha_fecha_diagnostico  <- as.Date(df.ins$fecha_diagnostico, format = "%Y-%m-%d")

df.ins$confirmados <- "Confirmados"
df.ins <- df.ins %>%
  dplyr::select(id_de_caso,
                ciudad_de_ubicaci_n,
                confirmados,
                fecha_de_notificaci_n,
                fis,
                fecha_fecha_diagnostico,
                fecha_de_muerte,
                fecha_fecha_reporte_web,
                everything())

########################CONFIRMADOS#####################
inc.casos.colombia.confirmados <- incidence(df.ins$fecha_fecha_reporte_web,
                                     groups = df.ins$confirmados)
serie.colombia <- xts(x = inc.casos.colombia.confirmados$counts,
                      order.by = inc.casos.colombia.confirmados$dates)
plot1_time <- dygraph(serie.colombia) %>% 
  dyRangeSelector(dateWindow = c("2020-03-03", "2020-08-08")) 

```

Column {data-width=450} 
-----------------------------------------------------------------------
```{r}

plot1_time

```